<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>File Filter - Coding Abap
    </title>
    <link rel="alternate" href="http://localhost:8080/feed.xml" type="application/rss+xml" title="Ramblings of an immor(t)al demigod">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/github.css">
    <!--workaroud -> node highlight doesn't add hljs class to pre, so css fails-->
    <script src="/js/highlight.pack.js"></script>
  </head>
  <body class="article-detail">
    <div id="fadeout"></div>
    <div id="flybar">
      <div class="navigation">
        <div class="button"><a id="logo" href="http://localhost:8080" alt="Coding Abap"><img src="http://localhost:8080/img/Coding Abap Logo Only.svg"></a></div>
      </div>
      <div class="navigation">
        <div class="button"><span>Menu1</span></div>
        <div class="contents menu"><a href="https://github.com/jnordberg/wintersmith">Wintersmith1</a><a href="https://github.com/jnordberg/wintersmith">Wintersmith2</a></div>
      </div>
      <div class="navigation">
        <div class="button"><span>Menu2</span></div>
        <div class="contents menu"><a href="https://github.com/jnordberg/wintersmith">Wintersmith3</a><a href="https://github.com/jnordberg/wintersmith">Wintersmith4</a></div>
      </div>
    </div>
    <header class="header">
      <div class="content-wrap">
        <h1>File Filter</h1>
        <p class="author">Written by <span class="author"><a href="mailto:diesire@gmail.com">Diesire</a></span>
        </p>
      </div>
    </header>
    <div id="content">
      <div class="content-wrap">
        <article class="article">
          <section class="content"><p>Do you remember the exact string to set a file filter in <span class="caps">ABAP</span> file chooser? I don’t, but class <code>cl_gui_frontend_services</code> has some nice predefined class&nbsp;atributes</p>
<hr>
<pre><code class="lang-abap">FILETYPE_ALL = <span class="string">'All Files (*.*)|*.*|'</span>
FILETYPE_EXCEL = <span class="string">'Microsoft Excel Files (*.<span class="caps">XLS</span>;*.XLSX;*.XLSM)|*.XLS;*.XLSX;*.XLSM|'</span>
FILETYPE_WORD = <span class="string">'Microsoft Word Files (*.<span class="caps">DOC</span>;*.DOCX;*.DOCM)|*.DOC;*.DOCX;*.DOCM|'</span>
FILETYPE_TEXT = <span class="string">'Text Files (*.<span class="caps">TXT</span>)|*.TXT|'</span>
FILETYPE_HTML = <span class="string">'<span class="caps">HTML</span> files (*.HTML, *.HTM)|*.HTML;*.HTM|'</span>
FILETYPE_RTF = <span class="string">'<span class="caps">RTF</span> Files (*.RTF)|*.RTF|'</span>
FILETYPE_XML = <span class="string">'<span class="caps">XML</span> (*.XML)|*.XML|'</span>
FILETYPE_POWERPOINT = <span class="string">'Microsoft PowerPoint Files (*<span class="caps">PPT</span>;*.PPTX;*.PPTM)|*PPT;*.PPTX;*.PPTM|'</span>
</code></pre>
<p>Usage&nbsp;example</p>
<pre><code class="lang-abap">cl_gui_frontend_services=&gt;file_open_dialog(
  <span class="simple"><span class="keyword"><span class="caps">EXPORTING</span></span></span>
    file_filter             =  cl_gui_frontend_services=&gt;FILETYPE_EXCEL
    multiselection          =  <span class="operator"><span class="keyword">space</span></span>
  <span class="simple"><span class="keyword"><span class="caps">CHANGING</span></span></span>
    file_table              =  lt_files
    rc                      =  lv_subrc
    user_action             =  lv_user_action
  <span class="simple"><span class="keyword"><span class="caps">EXCEPTIONS</span></span></span>
    file_open_dialog_failed = <span class="number">1</span>
    cntl_error              = <span class="number">2</span>
    error_no_gui            = <span class="number">3</span>
    not_supported_by_gui    = <span class="number">4</span>
    <span class="caps">OTHERS</span>                  = <span class="number">5</span> ).
</code></pre>
<p>Extra point for supporting <span class="caps">MS</span> Office multiple file&nbsp;extensions</p>
<p><img src="/articles/file-filter/file_filter.png" alt="Excel file filter in action"></p>
</section>
        </article>
      </div>
    </div>
    <footer>
      <div class="content-wrap">
        <div class="nav"><a href="/">« Full blog</a></div>
        <section class="about"><p>Wintersmith is made by <a href="http://johan-nordberg.com">Johan Nordberg</a> and licensed under the <a href="http://opensource.org/licenses/MIT">MIT-license</a>.
This footer text can be edited in about.md</p>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat.</p>
<p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum
dolore eu fugiat nulla pariatur.</p>
<p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
deserunt mollit anim id est laborum.</p>

        </section>
        <section class="copy">
          <p>&copy; 2015 Coding Abap &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a>
          </p>
        </section>
      </div>
    </footer>
    <!--workaroud -> node highlight doesn't add hljs class to pre, so css fails-->
    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </body>
</html>